{
  "hash": "29fdd3dc85ba0b4c471aab3d0f3e677f",
  "result": {
    "markdown": "---\ntitle: Non-parametric hypothesis tests with examples in Julia\ndescription: A tutorial on non-parametric hypothesis tests with examples in Julia.\nauthor:\n  - name: Dhruva Sambrani\n    orcid: 0000-0001-6254-4757\ndate: '2022-11-30'\ncategories:\n  - How To\n  - Non-parametric Tests\n  - Wilcoxon Test\n  - Mann Whitney U Test\n  - Kruskal-Wallis Test\nformat:\n  html:\n    code-fold: false\n    code-tools:\n      source: false\n      toggle: true\ncitation: true\ngoogle-scholar: true\n---\n\n::: {.callout-note collapse=\"true\"}\n### Update history\n\n2022-11-30 First draft\n:::\n\n# Introduction\n\nThis article is an extension of [Farmer. 2022. “Non-Parametric Hypothesis Tests with Examples in R.” November 18, 2022](https://www.dataalltheway.com/posts/011-non-parametric-hypothesis-tests-r). Please check out the parent article for the theoretical background.\n\n-   Wilcoxon rank-sum (Mann-Whitney U test) (@sec-u-test)\n-   Wilcoxon signed-rank test (@sec-wilcox-test)\n-   Kruskal-Wallis test (@sec-kruskal-test)\n\n## Import packages\n\n::: {.cell execution_count=1}\n``` {.julia .cell-code}\nimport Pkg\nPkg.activate(\".\")\nusing CSV\nusing Plots\nusing HypothesisTests\nusing DataFrames\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n  Activating project at `~/sandbox/dataalltheway/posts/011-01-non-parametric-hypothesis-tests-julia`\n```\n:::\n:::\n\n\n# Data import and cleanup\n\nI have subsetted the data from 1928 onward and dropped any columns with all NAs or zeros. To do so for `eachcol` of `data` we first calculate whether `all` the elements are `!ismissing` `&&` `!=0` (`!` = `not`). Then pick all rows for those columns, while `disallowmissing` data.\n\n::: {.cell execution_count=2}\n``` {.julia .cell-code}\ntemp_file = download(\"https://zenodo.org/record/7081360/files/1.%20Cement_emissions_data.csv\")\ndata = CSV.read(temp_file, DataFrame)\ndropmissing!(data, :Year)\nfilter!(:Year => >=(1928), data)\npicked_cols_mask = eachcol(data) .|> \n    col -> all(x->(!ismissing(x) && x!=0), col)\ndata = disallowmissing(data[!, picked_cols_mask])\n```\n\n::: {.cell-output .cell-output-display execution_count=3}\n```{=html}\n<div><div style = \"float: left;\"><span>94×24 DataFrame</span></div><div style = \"float: right;\"><span style = \"font-style: italic;\">69 rows omitted</span></div><div style = \"clear: both;\"></div></div><div class = \"data-frame\" style = \"overflow-x: scroll;\"><table class = \"data-frame\" style = \"margin-bottom: 6px;\"><thead><tr class = \"header\"><th class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">Row</th><th style = \"text-align: left;\">Year</th><th style = \"text-align: left;\">Argentina</th><th style = \"text-align: left;\">Australia</th><th style = \"text-align: left;\">Belgium</th><th style = \"text-align: left;\">Brazil</th><th style = \"text-align: left;\">Canada</th><th style = \"text-align: left;\">Chile</th><th style = \"text-align: left;\">China</th><th style = \"text-align: left;\">Democratic Republic of the Congo</th><th style = \"text-align: left;\">Denmark</th><th style = \"text-align: left;\">Egypt</th><th style = \"text-align: left;\">Finland</th><th style = \"text-align: left;\">Italy</th><th style = \"text-align: left;\">Japan</th><th style = \"text-align: left;\">Mozambique</th><th style = \"text-align: left;\">Norway</th><th style = \"text-align: left;\">Peru</th><th style = \"text-align: left;\">Portugal</th><th style = \"text-align: left;\">Romania</th><th style = \"text-align: left;\">Spain</th><th style = \"text-align: left;\">Sweden</th><th style = \"text-align: left;\">Turkey</th><th style = \"text-align: left;\">USA</th><th style = \"text-align: left;\">Global</th></tr><tr class = \"subheader headerLastRow\"><th class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\"></th><th title = \"Int64\" style = \"text-align: left;\">Int64</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th></tr></thead><tbody><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">1</td><td style = \"text-align: right;\">1928</td><td style = \"text-align: right;\">116.3</td><td style = \"text-align: right;\">378.0</td><td style = \"text-align: right;\">1505.0</td><td style = \"text-align: right;\">43.61</td><td style = \"text-align: right;\">868.6</td><td style = \"text-align: right;\">54.57</td><td style = \"text-align: right;\">39.78</td><td style = \"text-align: right;\">21.81</td><td style = \"text-align: right;\">385.2</td><td style = \"text-align: right;\">43.8</td><td style = \"text-align: right;\">138.1</td><td style = \"text-align: right;\">1519.0</td><td style = \"text-align: right;\">1897.0</td><td style = \"text-align: right;\">7.27</td><td style = \"text-align: right;\">158.3</td><td style = \"text-align: right;\">25.42</td><td style = \"text-align: right;\">36.34</td><td style = \"text-align: right;\">163.6</td><td style = \"text-align: right;\">763.2</td><td style = \"text-align: right;\">233.2</td><td style = \"text-align: right;\">29.07</td><td style = \"text-align: right;\">15420.0</td><td style = \"text-align: right;\">35616.0</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">2</td><td style = \"text-align: right;\">1929</td><td style = \"text-align: right;\">174.4</td><td style = \"text-align: right;\">356.2</td><td style = \"text-align: right;\">1606.0</td><td style = \"text-align: right;\">47.25</td><td style = \"text-align: right;\">963.0</td><td style = \"text-align: right;\">72.62</td><td style = \"text-align: right;\">76.51</td><td style = \"text-align: right;\">29.07</td><td style = \"text-align: right;\">396.1</td><td style = \"text-align: right;\">87.22</td><td style = \"text-align: right;\">138.1</td><td style = \"text-align: right;\">1730.0</td><td style = \"text-align: right;\">2112.0</td><td style = \"text-align: right;\">10.9</td><td style = \"text-align: right;\">159.1</td><td style = \"text-align: right;\">25.43</td><td style = \"text-align: right;\">43.61</td><td style = \"text-align: right;\">156.3</td><td style = \"text-align: right;\">901.3</td><td style = \"text-align: right;\">284.0</td><td style = \"text-align: right;\">32.71</td><td style = \"text-align: right;\">15000.0</td><td style = \"text-align: right;\">36873.0</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">3</td><td style = \"text-align: right;\">1930</td><td style = \"text-align: right;\">189.0</td><td style = \"text-align: right;\">348.9</td><td style = \"text-align: right;\">1508.0</td><td style = \"text-align: right;\">43.58</td><td style = \"text-align: right;\">926.7</td><td style = \"text-align: right;\">79.88</td><td style = \"text-align: right;\">73.45</td><td style = \"text-align: right;\">32.71</td><td style = \"text-align: right;\">385.2</td><td style = \"text-align: right;\">148.5</td><td style = \"text-align: right;\">101.6</td><td style = \"text-align: right;\">1723.0</td><td style = \"text-align: right;\">1853.0</td><td style = \"text-align: right;\">10.9</td><td style = \"text-align: right;\">160.2</td><td style = \"text-align: right;\">10.9</td><td style = \"text-align: right;\">47.29</td><td style = \"text-align: right;\">196.3</td><td style = \"text-align: right;\">908.4</td><td style = \"text-align: right;\">304.6</td><td style = \"text-align: right;\">29.07</td><td style = \"text-align: right;\">14290.0</td><td style = \"text-align: right;\">35561.0</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">4</td><td style = \"text-align: right;\">1931</td><td style = \"text-align: right;\">265.3</td><td style = \"text-align: right;\">196.3</td><td style = \"text-align: right;\">1218.0</td><td style = \"text-align: right;\">83.59</td><td style = \"text-align: right;\">799.5</td><td style = \"text-align: right;\">50.88</td><td style = \"text-align: right;\">97.93</td><td style = \"text-align: right;\">21.81</td><td style = \"text-align: right;\">250.8</td><td style = \"text-align: right;\">119.9</td><td style = \"text-align: right;\">79.95</td><td style = \"text-align: right;\">1519.0</td><td style = \"text-align: right;\">1788.0</td><td style = \"text-align: right;\">10.9</td><td style = \"text-align: right;\">109.7</td><td style = \"text-align: right;\">14.54</td><td style = \"text-align: right;\">47.25</td><td style = \"text-align: right;\">98.14</td><td style = \"text-align: right;\">806.8</td><td style = \"text-align: right;\">257.9</td><td style = \"text-align: right;\">50.83</td><td style = \"text-align: right;\">10810.0</td><td style = \"text-align: right;\">30931.0</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">5</td><td style = \"text-align: right;\">1932</td><td style = \"text-align: right;\">247.1</td><td style = \"text-align: right;\">123.6</td><td style = \"text-align: right;\">1039.0</td><td style = \"text-align: right;\">72.69</td><td style = \"text-align: right;\">363.4</td><td style = \"text-align: right;\">54.51</td><td style = \"text-align: right;\">79.57</td><td style = \"text-align: right;\">7.27</td><td style = \"text-align: right;\">203.6</td><td style = \"text-align: right;\">119.9</td><td style = \"text-align: right;\">76.23</td><td style = \"text-align: right;\">1545.0</td><td style = \"text-align: right;\">1843.0</td><td style = \"text-align: right;\">10.9</td><td style = \"text-align: right;\">117.3</td><td style = \"text-align: right;\">10.9</td><td style = \"text-align: right;\">58.15</td><td style = \"text-align: right;\">105.4</td><td style = \"text-align: right;\">705.1</td><td style = \"text-align: right;\">241.0</td><td style = \"text-align: right;\">54.46</td><td style = \"text-align: right;\">6656.0</td><td style = \"text-align: right;\">24721.0</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">6</td><td style = \"text-align: right;\">1933</td><td style = \"text-align: right;\">254.5</td><td style = \"text-align: right;\">159.9</td><td style = \"text-align: right;\">963.1</td><td style = \"text-align: right;\">109.0</td><td style = \"text-align: right;\">189.0</td><td style = \"text-align: right;\">69.05</td><td style = \"text-align: right;\">113.2</td><td style = \"text-align: right;\">3.63</td><td style = \"text-align: right;\">272.6</td><td style = \"text-align: right;\">141.7</td><td style = \"text-align: right;\">80.05</td><td style = \"text-align: right;\">1756.0</td><td style = \"text-align: right;\">2366.0</td><td style = \"text-align: right;\">10.18</td><td style = \"text-align: right;\">110.8</td><td style = \"text-align: right;\">14.53</td><td style = \"text-align: right;\">79.95</td><td style = \"text-align: right;\">109.0</td><td style = \"text-align: right;\">694.1</td><td style = \"text-align: right;\">200.7</td><td style = \"text-align: right;\">58.15</td><td style = \"text-align: right;\">5587.0</td><td style = \"text-align: right;\">23866.0</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">7</td><td style = \"text-align: right;\">1934</td><td style = \"text-align: right;\">279.8</td><td style = \"text-align: right;\">207.2</td><td style = \"text-align: right;\">937.6</td><td style = \"text-align: right;\">159.9</td><td style = \"text-align: right;\">272.6</td><td style = \"text-align: right;\">101.7</td><td style = \"text-align: right;\">97.93</td><td style = \"text-align: right;\">3.63</td><td style = \"text-align: right;\">381.6</td><td style = \"text-align: right;\">145.4</td><td style = \"text-align: right;\">112.7</td><td style = \"text-align: right;\">2013.0</td><td style = \"text-align: right;\">2304.0</td><td style = \"text-align: right;\">7.27</td><td style = \"text-align: right;\">123.6</td><td style = \"text-align: right;\">21.82</td><td style = \"text-align: right;\">90.94</td><td style = \"text-align: right;\">156.3</td><td style = \"text-align: right;\">672.3</td><td style = \"text-align: right;\">287.1</td><td style = \"text-align: right;\">83.59</td><td style = \"text-align: right;\">6900.0</td><td style = \"text-align: right;\">28542.0</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">8</td><td style = \"text-align: right;\">1935</td><td style = \"text-align: right;\">356.3</td><td style = \"text-align: right;\">276.2</td><td style = \"text-align: right;\">1087.0</td><td style = \"text-align: right;\">181.6</td><td style = \"text-align: right;\">272.6</td><td style = \"text-align: right;\">141.6</td><td style = \"text-align: right;\">156.1</td><td style = \"text-align: right;\">3.63</td><td style = \"text-align: right;\">374.3</td><td style = \"text-align: right;\">189.0</td><td style = \"text-align: right;\">134.3</td><td style = \"text-align: right;\">2086.0</td><td style = \"text-align: right;\">2904.0</td><td style = \"text-align: right;\">7.27</td><td style = \"text-align: right;\">130.8</td><td style = \"text-align: right;\">29.07</td><td style = \"text-align: right;\">105.4</td><td style = \"text-align: right;\">189.0</td><td style = \"text-align: right;\">668.7</td><td style = \"text-align: right;\">367.1</td><td style = \"text-align: right;\">65.42</td><td style = \"text-align: right;\">6684.0</td><td style = \"text-align: right;\">32090.0</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">9</td><td style = \"text-align: right;\">1936</td><td style = \"text-align: right;\">410.7</td><td style = \"text-align: right;\">323.5</td><td style = \"text-align: right;\">1163.0</td><td style = \"text-align: right;\">239.7</td><td style = \"text-align: right;\">388.9</td><td style = \"text-align: right;\">123.5</td><td style = \"text-align: right;\">428.5</td><td style = \"text-align: right;\">3.63</td><td style = \"text-align: right;\">392.4</td><td style = \"text-align: right;\">167.2</td><td style = \"text-align: right;\">163.5</td><td style = \"text-align: right;\">1890.0</td><td style = \"text-align: right;\">3082.0</td><td style = \"text-align: right;\">7.27</td><td style = \"text-align: right;\">149.0</td><td style = \"text-align: right;\">36.34</td><td style = \"text-align: right;\">119.9</td><td style = \"text-align: right;\">185.3</td><td style = \"text-align: right;\">297.9</td><td style = \"text-align: right;\">392.5</td><td style = \"text-align: right;\">69.05</td><td style = \"text-align: right;\">9950.0</td><td style = \"text-align: right;\">38763.0</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">10</td><td style = \"text-align: right;\">1937</td><td style = \"text-align: right;\">512.3</td><td style = \"text-align: right;\">363.4</td><td style = \"text-align: right;\">1486.0</td><td style = \"text-align: right;\">283.5</td><td style = \"text-align: right;\">483.4</td><td style = \"text-align: right;\">156.3</td><td style = \"text-align: right;\">437.7</td><td style = \"text-align: right;\">3.77</td><td style = \"text-align: right;\">334.4</td><td style = \"text-align: right;\">163.5</td><td style = \"text-align: right;\">203.4</td><td style = \"text-align: right;\">2155.0</td><td style = \"text-align: right;\">2984.0</td><td style = \"text-align: right;\">7.27</td><td style = \"text-align: right;\">159.9</td><td style = \"text-align: right;\">39.96</td><td style = \"text-align: right;\">127.1</td><td style = \"text-align: right;\">225.3</td><td style = \"text-align: right;\">189.0</td><td style = \"text-align: right;\">432.5</td><td style = \"text-align: right;\">105.4</td><td style = \"text-align: right;\">10370.0</td><td style = \"text-align: right;\">40829.0</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">11</td><td style = \"text-align: right;\">1938</td><td style = \"text-align: right;\">614.3</td><td style = \"text-align: right;\">178.1</td><td style = \"text-align: right;\">1508.0</td><td style = \"text-align: right;\">305.5</td><td style = \"text-align: right;\">432.5</td><td style = \"text-align: right;\">181.7</td><td style = \"text-align: right;\">9.18</td><td style = \"text-align: right;\">7.5</td><td style = \"text-align: right;\">316.2</td><td style = \"text-align: right;\">185.3</td><td style = \"text-align: right;\">236.2</td><td style = \"text-align: right;\">2279.0</td><td style = \"text-align: right;\">2729.0</td><td style = \"text-align: right;\">11.99</td><td style = \"text-align: right;\">163.6</td><td style = \"text-align: right;\">50.86</td><td style = \"text-align: right;\">130.8</td><td style = \"text-align: right;\">221.7</td><td style = \"text-align: right;\">294.4</td><td style = \"text-align: right;\">490.6</td><td style = \"text-align: right;\">130.9</td><td style = \"text-align: right;\">9239.0</td><td style = \"text-align: right;\">38551.0</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">12</td><td style = \"text-align: right;\">1939</td><td style = \"text-align: right;\">556.0</td><td style = \"text-align: right;\">338.0</td><td style = \"text-align: right;\">1261.0</td><td style = \"text-align: right;\">345.5</td><td style = \"text-align: right;\">450.7</td><td style = \"text-align: right;\">167.2</td><td style = \"text-align: right;\">223.4</td><td style = \"text-align: right;\">17.44</td><td style = \"text-align: right;\">345.3</td><td style = \"text-align: right;\">185.0</td><td style = \"text-align: right;\">279.6</td><td style = \"text-align: right;\">2526.0</td><td style = \"text-align: right;\">2508.0</td><td style = \"text-align: right;\">14.54</td><td style = \"text-align: right;\">192.6</td><td style = \"text-align: right;\">58.18</td><td style = \"text-align: right;\">145.4</td><td style = \"text-align: right;\">261.7</td><td style = \"text-align: right;\">588.8</td><td style = \"text-align: right;\">585.1</td><td style = \"text-align: right;\">141.7</td><td style = \"text-align: right;\">10790.0</td><td style = \"text-align: right;\">35687.0</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">13</td><td style = \"text-align: right;\">1940</td><td style = \"text-align: right;\">534.4</td><td style = \"text-align: right;\">348.8</td><td style = \"text-align: right;\">105.4</td><td style = \"text-align: right;\">367.1</td><td style = \"text-align: right;\">592.4</td><td style = \"text-align: right;\">189.0</td><td style = \"text-align: right;\">272.4</td><td style = \"text-align: right;\">11.45</td><td style = \"text-align: right;\">218.1</td><td style = \"text-align: right;\">178.1</td><td style = \"text-align: right;\">149.0</td><td style = \"text-align: right;\">2373.0</td><td style = \"text-align: right;\">2101.0</td><td style = \"text-align: right;\">14.54</td><td style = \"text-align: right;\">167.2</td><td style = \"text-align: right;\">61.78</td><td style = \"text-align: right;\">134.5</td><td style = \"text-align: right;\">196.3</td><td style = \"text-align: right;\">770.5</td><td style = \"text-align: right;\">345.3</td><td style = \"text-align: right;\">130.9</td><td style = \"text-align: right;\">11550.0</td><td style = \"text-align: right;\">31431.0</td></tr><tr><td style = \"text-align: right;\">&vellip;</td><td style = \"text-align: right;\">&vellip;</td><td style = \"text-align: right;\">&vellip;</td><td style = \"text-align: right;\">&vellip;</td><td style = \"text-align: right;\">&vellip;</td><td style = \"text-align: right;\">&vellip;</td><td style = \"text-align: right;\">&vellip;</td><td style = \"text-align: right;\">&vellip;</td><td style = \"text-align: right;\">&vellip;</td><td style = \"text-align: right;\">&vellip;</td><td style = \"text-align: right;\">&vellip;</td><td style = \"text-align: right;\">&vellip;</td><td style = \"text-align: right;\">&vellip;</td><td style = \"text-align: right;\">&vellip;</td><td style = \"text-align: right;\">&vellip;</td><td style = \"text-align: right;\">&vellip;</td><td style = \"text-align: right;\">&vellip;</td><td style = \"text-align: right;\">&vellip;</td><td style = \"text-align: right;\">&vellip;</td><td style = \"text-align: right;\">&vellip;</td><td style = \"text-align: right;\">&vellip;</td><td style = \"text-align: right;\">&vellip;</td><td style = \"text-align: right;\">&vellip;</td><td style = \"text-align: right;\">&vellip;</td><td style = \"text-align: right;\">&vellip;</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">83</td><td style = \"text-align: right;\">2010</td><td style = \"text-align: right;\">4178.0</td><td style = \"text-align: right;\">3549.0</td><td style = \"text-align: right;\">2582.0</td><td style = \"text-align: right;\">21290.0</td><td style = \"text-align: right;\">6005.0</td><td style = \"text-align: right;\">1046.0</td><td style = \"text-align: right;\">639600.0</td><td style = \"text-align: right;\">189.0</td><td style = \"text-align: right;\">672.2</td><td style = \"text-align: right;\">20510.0</td><td style = \"text-align: right;\">525.7</td><td style = \"text-align: right;\">13280.0</td><td style = \"text-align: right;\">24320.0</td><td style = \"text-align: right;\">340.9</td><td style = \"text-align: right;\">754.0</td><td style = \"text-align: right;\">3338.0</td><td style = \"text-align: right;\">3376.0</td><td style = \"text-align: right;\">2778.0</td><td style = \"text-align: right;\">11200.0</td><td style = \"text-align: right;\">1324.0</td><td style = \"text-align: right;\">29980.0</td><td style = \"text-align: right;\">31450.0</td><td style = \"text-align: right;\">1.2549e6</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">84</td><td style = \"text-align: right;\">2011</td><td style = \"text-align: right;\">4586.0</td><td style = \"text-align: right;\">3496.0</td><td style = \"text-align: right;\">2762.0</td><td style = \"text-align: right;\">22840.0</td><td style = \"text-align: right;\">6020.0</td><td style = \"text-align: right;\">1080.0</td><td style = \"text-align: right;\">708600.0</td><td style = \"text-align: right;\">175.2</td><td style = \"text-align: right;\">861.8</td><td style = \"text-align: right;\">20100.0</td><td style = \"text-align: right;\">557.8</td><td style = \"text-align: right;\">12580.0</td><td style = \"text-align: right;\">24980.0</td><td style = \"text-align: right;\">373.3</td><td style = \"text-align: right;\">749.0</td><td style = \"text-align: right;\">3300.0</td><td style = \"text-align: right;\">2813.0</td><td style = \"text-align: right;\">3089.0</td><td style = \"text-align: right;\">9523.0</td><td style = \"text-align: right;\">1361.0</td><td style = \"text-align: right;\">31450.0</td><td style = \"text-align: right;\">32210.0</td><td style = \"text-align: right;\">1.3498e6</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">85</td><td style = \"text-align: right;\">2012</td><td style = \"text-align: right;\">4184.0</td><td style = \"text-align: right;\">3518.0</td><td style = \"text-align: right;\">2643.0</td><td style = \"text-align: right;\">25000.0</td><td style = \"text-align: right;\">6532.0</td><td style = \"text-align: right;\">1128.0</td><td style = \"text-align: right;\">714800.0</td><td style = \"text-align: right;\">157.9</td><td style = \"text-align: right;\">871.1</td><td style = \"text-align: right;\">20970.0</td><td style = \"text-align: right;\">497.2</td><td style = \"text-align: right;\">10070.0</td><td style = \"text-align: right;\">25620.0</td><td style = \"text-align: right;\">452.7</td><td style = \"text-align: right;\">725.0</td><td style = \"text-align: right;\">3731.0</td><td style = \"text-align: right;\">2550.0</td><td style = \"text-align: right;\">3150.0</td><td style = \"text-align: right;\">8754.0</td><td style = \"text-align: right;\">1479.0</td><td style = \"text-align: right;\">31370.0</td><td style = \"text-align: right;\">35270.0</td><td style = \"text-align: right;\">1.3846e6</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">86</td><td style = \"text-align: right;\">2013</td><td style = \"text-align: right;\">4581.0</td><td style = \"text-align: right;\">3294.0</td><td style = \"text-align: right;\">2541.0</td><td style = \"text-align: right;\">26650.0</td><td style = \"text-align: right;\">5973.0</td><td style = \"text-align: right;\">1086.0</td><td style = \"text-align: right;\">748300.0</td><td style = \"text-align: right;\">174.0</td><td style = \"text-align: right;\">867.1</td><td style = \"text-align: right;\">20210.0</td><td style = \"text-align: right;\">481.8</td><td style = \"text-align: right;\">8877.0</td><td style = \"text-align: right;\">26810.0</td><td style = \"text-align: right;\">505.6</td><td style = \"text-align: right;\">731.0</td><td style = \"text-align: right;\">4257.0</td><td style = \"text-align: right;\">2814.0</td><td style = \"text-align: right;\">2695.0</td><td style = \"text-align: right;\">7642.0</td><td style = \"text-align: right;\">1402.0</td><td style = \"text-align: right;\">33910.0</td><td style = \"text-align: right;\">36370.0</td><td style = \"text-align: right;\">1.4441e6</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">87</td><td style = \"text-align: right;\">2014</td><td style = \"text-align: right;\">4336.0</td><td style = \"text-align: right;\">3138.0</td><td style = \"text-align: right;\">2643.0</td><td style = \"text-align: right;\">26910.0</td><td style = \"text-align: right;\">5912.0</td><td style = \"text-align: right;\">1022.0</td><td style = \"text-align: right;\">778600.0</td><td style = \"text-align: right;\">127.9</td><td style = \"text-align: right;\">887.3</td><td style = \"text-align: right;\">20760.0</td><td style = \"text-align: right;\">468.8</td><td style = \"text-align: right;\">8339.0</td><td style = \"text-align: right;\">26560.0</td><td style = \"text-align: right;\">585.9</td><td style = \"text-align: right;\">727.0</td><td style = \"text-align: right;\">4590.0</td><td style = \"text-align: right;\">3096.0</td><td style = \"text-align: right;\">2944.0</td><td style = \"text-align: right;\">8897.0</td><td style = \"text-align: right;\">1399.0</td><td style = \"text-align: right;\">34500.0</td><td style = \"text-align: right;\">39440.0</td><td style = \"text-align: right;\">1.4999e6</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">88</td><td style = \"text-align: right;\">2015</td><td style = \"text-align: right;\">4571.0</td><td style = \"text-align: right;\">3076.0</td><td style = \"text-align: right;\">2348.0</td><td style = \"text-align: right;\">25080.0</td><td style = \"text-align: right;\">6185.0</td><td style = \"text-align: right;\">1033.0</td><td style = \"text-align: right;\">722000.0</td><td style = \"text-align: right;\">154.6</td><td style = \"text-align: right;\">931.5</td><td style = \"text-align: right;\">21650.0</td><td style = \"text-align: right;\">462.1</td><td style = \"text-align: right;\">8196.0</td><td style = \"text-align: right;\">25940.0</td><td style = \"text-align: right;\">614.2</td><td style = \"text-align: right;\">672.0</td><td style = \"text-align: right;\">4476.0</td><td style = \"text-align: right;\">2921.0</td><td style = \"text-align: right;\">3337.0</td><td style = \"text-align: right;\">9216.0</td><td style = \"text-align: right;\">1537.0</td><td style = \"text-align: right;\">34440.0</td><td style = \"text-align: right;\">39910.0</td><td style = \"text-align: right;\">1.4444e6</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">89</td><td style = \"text-align: right;\">2016</td><td style = \"text-align: right;\">4029.0</td><td style = \"text-align: right;\">2931.0</td><td style = \"text-align: right;\">2436.0</td><td style = \"text-align: right;\">22420.0</td><td style = \"text-align: right;\">6114.0</td><td style = \"text-align: right;\">1120.0</td><td style = \"text-align: right;\">743000.0</td><td style = \"text-align: right;\">98.04</td><td style = \"text-align: right;\">1095.0</td><td style = \"text-align: right;\">22820.0</td><td style = \"text-align: right;\">553.2</td><td style = \"text-align: right;\">7680.0</td><td style = \"text-align: right;\">25970.0</td><td style = \"text-align: right;\">947.8</td><td style = \"text-align: right;\">684.0</td><td style = \"text-align: right;\">4340.0</td><td style = \"text-align: right;\">2297.0</td><td style = \"text-align: right;\">3181.0</td><td style = \"text-align: right;\">9414.0</td><td style = \"text-align: right;\">1554.0</td><td style = \"text-align: right;\">37530.0</td><td style = \"text-align: right;\">39440.0</td><td style = \"text-align: right;\">1.4876e6</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">90</td><td style = \"text-align: right;\">2017</td><td style = \"text-align: right;\">4362.0</td><td style = \"text-align: right;\">3019.0</td><td style = \"text-align: right;\">2291.0</td><td style = \"text-align: right;\">19080.0</td><td style = \"text-align: right;\">6827.0</td><td style = \"text-align: right;\">865.9</td><td style = \"text-align: right;\">758200.0</td><td style = \"text-align: right;\">348.7</td><td style = \"text-align: right;\">1194.0</td><td style = \"text-align: right;\">21770.0</td><td style = \"text-align: right;\">603.7</td><td style = \"text-align: right;\">7711.0</td><td style = \"text-align: right;\">26430.0</td><td style = \"text-align: right;\">910.6</td><td style = \"text-align: right;\">766.0</td><td style = \"text-align: right;\">4291.0</td><td style = \"text-align: right;\">2531.0</td><td style = \"text-align: right;\">3310.0</td><td style = \"text-align: right;\">9449.0</td><td style = \"text-align: right;\">1484.0</td><td style = \"text-align: right;\">39470.0</td><td style = \"text-align: right;\">40320.0</td><td style = \"text-align: right;\">1.5079e6</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">91</td><td style = \"text-align: right;\">2018</td><td style = \"text-align: right;\">4369.0</td><td style = \"text-align: right;\">2942.0</td><td style = \"text-align: right;\">2534.0</td><td style = \"text-align: right;\">19340.0</td><td style = \"text-align: right;\">6915.0</td><td style = \"text-align: right;\">782.2</td><td style = \"text-align: right;\">786700.0</td><td style = \"text-align: right;\">406.1</td><td style = \"text-align: right;\">1160.0</td><td style = \"text-align: right;\">21000.0</td><td style = \"text-align: right;\">601.7</td><td style = \"text-align: right;\">7757.0</td><td style = \"text-align: right;\">26180.0</td><td style = \"text-align: right;\">930.0</td><td style = \"text-align: right;\">730.0</td><td style = \"text-align: right;\">4320.0</td><td style = \"text-align: right;\">2251.0</td><td style = \"text-align: right;\">3505.0</td><td style = \"text-align: right;\">9667.0</td><td style = \"text-align: right;\">1607.0</td><td style = \"text-align: right;\">39410.0</td><td style = \"text-align: right;\">38970.0</td><td style = \"text-align: right;\">1.5692e6</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">92</td><td style = \"text-align: right;\">2019</td><td style = \"text-align: right;\">4141.0</td><td style = \"text-align: right;\">3040.0</td><td style = \"text-align: right;\">2819.0</td><td style = \"text-align: right;\">19860.0</td><td style = \"text-align: right;\">7125.0</td><td style = \"text-align: right;\">825.3</td><td style = \"text-align: right;\">826900.0</td><td style = \"text-align: right;\">451.0</td><td style = \"text-align: right;\">1129.0</td><td style = \"text-align: right;\">19670.0</td><td style = \"text-align: right;\">583.5</td><td style = \"text-align: right;\">7912.0</td><td style = \"text-align: right;\">25330.0</td><td style = \"text-align: right;\">1011.0</td><td style = \"text-align: right;\">722.0</td><td style = \"text-align: right;\">4546.0</td><td style = \"text-align: right;\">2225.0</td><td style = \"text-align: right;\">3828.0</td><td style = \"text-align: right;\">9064.0</td><td style = \"text-align: right;\">1349.0</td><td style = \"text-align: right;\">32350.0</td><td style = \"text-align: right;\">40900.0</td><td style = \"text-align: right;\">1.6175e6</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">93</td><td style = \"text-align: right;\">2020</td><td style = \"text-align: right;\">3508.0</td><td style = \"text-align: right;\">2820.0</td><td style = \"text-align: right;\">2634.0</td><td style = \"text-align: right;\">22050.0</td><td style = \"text-align: right;\">6625.0</td><td style = \"text-align: right;\">825.3</td><td style = \"text-align: right;\">858200.0</td><td style = \"text-align: right;\">451.0</td><td style = \"text-align: right;\">1227.0</td><td style = \"text-align: right;\">18130.0</td><td style = \"text-align: right;\">569.7</td><td style = \"text-align: right;\">7059.0</td><td style = \"text-align: right;\">24490.0</td><td style = \"text-align: right;\">1011.0</td><td style = \"text-align: right;\">725.0</td><td style = \"text-align: right;\">4546.0</td><td style = \"text-align: right;\">2310.0</td><td style = \"text-align: right;\">3901.0</td><td style = \"text-align: right;\">8192.0</td><td style = \"text-align: right;\">1272.0</td><td style = \"text-align: right;\">40810.0</td><td style = \"text-align: right;\">40690.0</td><td style = \"text-align: right;\">1.6375e6</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">94</td><td style = \"text-align: right;\">2021</td><td style = \"text-align: right;\">4671.0</td><td style = \"text-align: right;\">2820.0</td><td style = \"text-align: right;\">2634.0</td><td style = \"text-align: right;\">23790.0</td><td style = \"text-align: right;\">6625.0</td><td style = \"text-align: right;\">825.3</td><td style = \"text-align: right;\">853000.0</td><td style = \"text-align: right;\">451.0</td><td style = \"text-align: right;\">1227.0</td><td style = \"text-align: right;\">16160.0</td><td style = \"text-align: right;\">569.7</td><td style = \"text-align: right;\">7059.0</td><td style = \"text-align: right;\">23790.0</td><td style = \"text-align: right;\">1011.0</td><td style = \"text-align: right;\">701.3</td><td style = \"text-align: right;\">4546.0</td><td style = \"text-align: right;\">2310.0</td><td style = \"text-align: right;\">3901.0</td><td style = \"text-align: right;\">8609.0</td><td style = \"text-align: right;\">1272.0</td><td style = \"text-align: right;\">44390.0</td><td style = \"text-align: right;\">41200.0</td><td style = \"text-align: right;\">1.6729e6</td></tr></tbody></table></div>\n```\n:::\n:::\n\n\n::: {.cell execution_count=3}\n``` {.julia .cell-code}\nplot(\n\tdata[!, :Year], \n\tArray(log.(data[!, Not(:Year)])), \n\tlabel=reshape(string.(propertynames(data)[2:end]), 1, :),\n\tlegend= :outerright,\n\tsize=(900, 400)\n)\n```\n\n::: {.cell-output .cell-output-display execution_count=4}\n![](index_files/figure-html/cell-4-output-1.svg){}\n:::\n:::\n\n\n# Wilcoxon rank-sum (Mann-Whitney U test){#sec-u-test}\n\n::: {.cell execution_count=4}\n``` {.julia .cell-code}\nmwut_results = MannWhitneyUTest(data[!, :USA], data[!, :Canada], )\n```\n\n::: {.cell-output .cell-output-display execution_count=5}\n```\nApproximate Mann-Whitney U test\n-------------------------------\nPopulation details:\n    parameter of interest:   Location parameter (pseudomedian)\n    value under h_0:         0\n    point estimate:          28503.5\n\nTest summary:\n    outcome with 95% confidence: reject h_0\n    two-sided p-value:           <1e-30\n\nDetails:\n    number of observations in each group: [94, 94]\n    Mann-Whitney-U statistic:             8763.0\n    rank sums:                            [13228.0, 4538.0]\n    adjustment for ties:                  24.0\n    normal approximation (μ, σ):          (4345.0, 373.05)\n```\n:::\n:::\n\n\n## Right tailed test\n\n::: {.cell execution_count=5}\n``` {.julia .cell-code}\npvalue(mwut_results, tail=:right)\n```\n\n::: {.cell-output .cell-output-display execution_count=6}\n```\n1.2040605143479147e-31\n```\n:::\n:::\n\n\n# Wilcoxon signed-rank test {#sec-wilcox-test}\n\n::: {.cell execution_count=6}\n``` {.julia .cell-code}\ndt = select(filter(:Year=> y-> y==2000 || y==2020, data), Not(:Year))\nx = collect(dt[1, :])\ny = collect(dt[2, :])\nSignedRankTest(x, y)\n```\n\n::: {.cell-output .cell-output-display execution_count=7}\n```\nExact Wilcoxon signed rank test\n-------------------------------\nPopulation details:\n    parameter of interest:   Location parameter (pseudomedian)\n    value under h_0:         0\n    point estimate:          16.0\n    95% confidence interval: (-3848.0, 621.5)\n\nTest summary:\n    outcome with 95% confidence: fail to reject h_0\n    two-sided p-value:           0.5803\n\nDetails:\n    number of observations:      23\n    Wilcoxon rank-sum statistic: 119.0\n    rank sums:                   [119.0, 157.0]\n    adjustment for ties:         0.0\n```\n:::\n:::\n\n\n# Kruskal-Wallis test {#sec-kruskal-test}\n\n::: {.cell execution_count=7}\n``` {.julia .cell-code}\nKruskalWallisTest(collect(eachcol(data[:, Not(:Year)]))...)\n```\n\n::: {.cell-output .cell-output-display execution_count=8}\n```\nKruskal-Wallis rank sum test (chi-square approximation)\n-------------------------------------------------------\nPopulation details:\n    parameter of interest:   Location parameters\n    value under h_0:         \"all equal\"\n    point estimate:          NaN\n\nTest summary:\n    outcome with 95% confidence: reject h_0\n    one-sided p-value:           <1e-99\n\nDetails:\n    number of observation in each group: [94, 94, 94, 94, 94, 94, 94, 94, 94, 94  …  94, 94, 94, 94, 94, 94, 94, 94, 94, 94]\n    χ²-statistic:                        1253.58\n    rank sums:                           [100736.0, 98787.5, 1.11532e5, 1.21338e5, 1.21336e5, 55862.0, 138744.0, 20383.0, 71558.5, 1.03662e5  …  19940.0, 59493.0, 68485.5, 84067.0, 1.0239e5, 132068.0, 83910.0, 1.10562e5, 1.7974e5, 195500.0]\n    degrees of freedom:                  22\n    adjustment for ties:                 0.999999\n```\n:::\n:::\n\n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js\" integrity=\"sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js\" integrity=\"sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==\" crossorigin=\"anonymous\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n"
      ]
    }
  }
}